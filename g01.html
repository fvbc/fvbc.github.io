<!DOCTYPE html>
<html>
  <head>
    <title>Fireworks Animation</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        background-color: black;
      }
      canvas {
        display: block;
      }
    </style>
  </head>
  <body>
    <canvas id="fireworksCanvas"></canvas>
    <script>
      const canvas = document.getElementById("fireworksCanvas");
      const context = canvas.getContext("2d");

      // キャンバスのサイズを設定
      const scale = window.devicePixelRatio || 1;
      const width = window.innerWidth;
      const height = window.innerHeight;
      canvas.width = width * scale;
      canvas.height = height * scale;
      context.scale(scale, scale);

      const fireworks = [];

      // 花火のクラス
      class Firework {
        constructor() {
          this.x = Math.random() * canvas.width;
          this.y = canvas.height;
          this.color = getRandomColor();
          this.radius = 2;
          this.velocity = {
            x: Math.random() * 5 - 2.5,
            y: Math.random() * -15 - 10,
          };
          this.gravity = 0.2;
          this.opacity = 1;
          this.isExploded = false;
          this.particles = [];
        }

        explode() {
          this.isExploded = true;
          for (let i = 0; i < 100; i++) {
            const particle = new Particle(this.x, this.y, this.color);
            this.particles.push(particle);
          }
        }

        update() {
          if (!this.isExploded) {
            this.x += this.velocity.x;
            this.y += this.velocity.y;
            this.velocity.y += this.gravity;
            if (this.velocity.y >= 0) {
              this.explode();
            }
          } else {
            for (let i = this.particles.length - 1; i >= 0; i--) {
              this.particles[i].update();
              if (this.particles[i].opacity <= 0) {
                this.particles.splice(i, 1);
              }
            }
          }
        }

        draw() {
          context.beginPath();
          context.fillStyle = this.color;
          if (!this.isExploded) {
            context.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
          } else {
            for (const particle of this.particles) {
              context.moveTo(this.x, this.y);
              context.lineTo(particle.x, particle.y);
            }
          }
          context.closePath();
          context.fill();
        }
      }

      // パーティクルのクラス
      class Particle {
        constructor(x, y, color) {
          this.x = x;
          this.y = y;
          this.color = color;
          this.radius = 2;
          this.velocity = {
            x: Math.random() * 2 - 1,
            y: Math.random() * 2 - 1,
          };
          this.opacity = 1;
        }

        update() {
          this.x += this.velocity.x;
          this.y += this.velocity.y;
          this.velocity.x *= 0.99;
          this.velocity.y *= 0.99;
          this.opacity -= 0.02;
        }

        draw() {
          context.beginPath();
          context.fillStyle = this.color;
          context.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
          context.closePath();
          context.globalAlpha = this.opacity;
          context.fill();
          context.globalAlpha = 1;
        }
      }

      function getRandomColor() {
        const colors = ["#FF0000", "#00FF00", "#0000FF", "#FFFF00", "#FF00FF", "#00FFFF"];
        return colors[Math.floor(Math.random() * colors.length)];
      }

      function createFirework() {
        const firework = new Firework();
        fireworks.push(firework);
      }

      function updateFireworks() {
        for (let i = fireworks.length - 1; i >= 0; i--) {
          fireworks[i].update();
          if (fireworks[i].opacity <= 0) {
            fireworks.splice(i, 1);
          }
        }
      }

      function drawFireworks() {
        context.clearRect(0, 0, canvas.width, canvas.height);
        for (const firework of fireworks) {
          firework.draw();
        }
      }

      setInterval(createFirework, 2000);

      function animate() {
        updateFireworks();
        drawFireworks();
        requestAnimationFrame(animate);
      }

      animate();
    </script>
  </body>
</html>
